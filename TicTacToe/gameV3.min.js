var imageArray=["catSm.png","dogSm.png","cubsSm.png","soxSm.png","x.png","o.png","fancyGreenBack.png","nscdsLogoTr.png"],preloadArray=[],options=[{o:"cubs",x:"sox"},{o:"o",x:"x"},{o:"cat",x:"dog"}];function preloadImages(){for(var e=0;e<imageArray.length;e++){var r=new Image;r.onload=notifyComplete,r.src="images/"+imageArray[e],preloadArray.push(r)}}function notifyComplete(){console.log(this.src+" into the cache.")}preloadImages();var winningPlayer,modal=$("#modalWrapper"),textWrapper=$("#textWrapper"),player1Turn=!0,turn=0,gameOver=!1,choice=0,playerClass=options[0].o,computerClass=options[0].x;function computerAI(){if(!gameOver){var e,r=$("[player=0]"),a=Math.floor(Math.random()*r.length),l=r.eq(a);if(0==turn&&(l=$("[r=0][c=0]")),2==turn)(e=$("[r=1][c=1][player=0]")).length>0?1==$("[r=0][c=1][player=1]").length||1==$("[r=0][c=2][player=1]").length||1==$("[r=1][c=2][player=1]").length||1==$("[r=2][c=2][player=1]").length?(l=$("[r=2][c=0]"),console.log("(2,0)")):(l=$("[r=0][c=2]"),console.log("(0,2)")):l=$("[r=2][c=2]");if(4==turn&&(1==$("[r=2][c=2][player=0]").length?l=$("[r=2][c=2]"):1==$("[r=1][c=1][player=0]").length&&(l=findCornerSpot())),1==turn)(e=$("[r=1][c=1][player=0]")).length>0?(l=e,console.log("middleSpot available!")):(l=findCornerSpot(),console.log("middleSpot not available!"));if(3==turn)$("[r=1][c=1]").find("."+playerClass).length>0?l=findCornerSpot():3==$("[d1][player=0],[d2][player=0]").length?(r=$("[player=0]").not("[d1]").not("[d2]")).each(function(){var e=$(this);hasEmptyRowColumn(e)&&(l=e)}):$("[r=0][c=1][player=1]").length+$("[r=1][c=0][player=1]").length==2?l=$("[r=0][c=0]"):$("[r=0][c=1][player=1]").length+$("[r=1][c=2][player=1]").length==2?l=$("[r=0][c=2]"):$("[r=1][c=0][player=1]").length+$("[r=2][c=1][player=1]").length==2?l=$("[r=2][c=0]"):$("[r=2][c=1][player=1]").length+$("[r=1][c=2][player=1]").length==2?l=$("[r=2][c=2]"):(r=$("[player=0]").not("[d1]").not("[d2]"),console.log("turn 2 available spots:"+r.length),a=Math.floor(Math.random()*r.length),l=r.eq(a));var o=playPiece("."+computerClass);o.length>0?l=o:(o=playPiece("."+playerClass)).length>0&&(l=o);var n=$(".marker",l);n.addClass(computerClass),processTurn(n,l),player1Turn=!0}}function hasEmptyRowColumn(e){var r=e.attr("r"),a=e.attr("c"),l=$("[r="+r+"][player=0]").length,o=$("[c="+a+"][player=0]").length;return 3==l||3==o}function findCornerSpot(){var e=$("[d1][player=0],[d2][player=0]");console.log(e.length);var r=Math.floor(Math.random()*e.length);return e.eq(r)}function playPiece(e){for(var r=0,a=!1,l=!1;r<3&&!a;){var o=playSpot($("[c="+r+"]"),e);o.length>0&&(l=o,a=!0),r++}for(r=0;r<3&&!a;){(o=playSpot($("[r="+r+"]"),e)).length>0&&(l=o,a=!0),r++}for(var n=1;n<=2&&!a;){(o=playSpot($("[d"+n+"]"),e)).length>0&&(l=o,a=!0),n++}return l}function playSpot(e,r){if(2==e.find(r).length){console.log("2 pieces found in current group");var a=e.filter("[player=0]");return console.log(a.length),a}return!1}function processTurn(e,r){turn++,TweenMax.from(e,.5,{opacity:0,scale:0,rotation:360,ease:Bounce.easeOut});var a=player1Turn?1:2;r.attr("player",a),checkWin(e)?(showModal(!0,(winningPlayer=player1Turn?"Player 1":"Computer")+" wins!!"),gameOver=!0):9===turn&&(showModal(!0,"DRAW"),winningPlayer=0,gameOver=!0)}function checkWin(e){var r=$(e).closest(".spot"),a=$(r).attr("player"),l=parseInt(r.attr("r"),10),o=parseInt(r.attr("c"),10),n=$("[r="+l+"][player="+a+"]");return 3==n.length||(3==(n=$("[c="+o+"][player="+a+"]")).length||(3==(n=$("[d1][player="+a+"]")).length||3==(n=$("[d2][player="+a+"]")).length))}function resetSpots(){$(".marker").removeClass(playerClass+" "+computerClass),TweenMax.to(".marker",0,{opacity:1,scale:1}),$(".spot").attr("player","0"),setTimeout(function(){chooseFirstPlayer()},1)}function chooseFirstPlayer(){console.log("choosing first player"),0==winningPlayer&&(player1Turn?player1Turn=!0:computerAI()),"Player 1"==winningPlayer&&(player1Turn=!0),"Computer"==winningPlayer&&(player1Turn=!1,computerAI())}function showModal(e,r){e?(textWrapper.text(r),modal.fadeIn()):modal.fadeOut()}console.log(playerClass,computerClass),$(".marker").click(function(){console.log("click");var e=$(this).closest(".spot");"0"===e.attr("player")&&player1Turn&&($(this).addClass(playerClass),processTurn(this,e),player1Turn=!1,setTimeout(function(){computerAI()},1e3))}),$("#restart").click(function(){TweenMax.staggerTo(".spot .marker",.5,{opacity:0,scale:0,rotation:360,ease:Bounce.easeOut},.1,resetSpots),showModal(!1),turn=0,gameOver=!1}),$("#themes").change(function(){choice=parseInt($(this).children("option:selected").val()),console.log(choice);var e=playerClass,r=computerClass;playerClass=options[choice].o,computerClass=options[choice].x,console.log(playerClass,computerClass),$("."+e).addClass(playerClass),$("."+r).addClass(computerClass),$("."+e).removeClass(e),$("."+r).removeClass(r)});